= Отчет по лабораторной работе 3
:listing-caption: Листинг
:figure-caption: Рис
:source-highlighter: coderay

Студент: Беляев Максим

Группа: ПИМ-22

== 1. Постановка задачи

В процессе выполнения лабораторной работы необходимо выполнить следующие задачи:

. ООП.
.. Создать интегрфейс
.. Создать абстрактный класс
.. Создать класс, имплементирующий интерфейс
.. Создать класс-наследник абстрактного класса

. Reflection
.. Выгрузить все поля и методы класса с помощью рефлексии
.. Вызвать несколько методов класса
.. Вывести на экран всех предков класса

. Collections
.. Ознакомится со всеми коллекциями java (list, set, map) и их реализацией
.. Продемонстрировать в программе работу с каждым видом реализации коллекции (list, set, map)

. Generics
.. Сделать дженерик на класс
.. Сделать дженерик на метод


== 2. Разработка задачи

=== 2.1 Структура проекта

Проект разделен на следующие директории:

docs::
Данная документация

src::
Исходный код лабораторной работы

src/main/java/ru/rsatu/oop:::
Задание 1

src/main/java/ru/rsatu/reflect::
Задание 2

src/main/java/ru/rsatu/collections::
Задание 3

== 3. Информация о реализации

=== 3.1 Задание 1

Для выполнения первого задания был создан интерфейс MoneyInteface.

.MoneyInteface
[source,java]
----
package ru.rsatu.oop;

public interface MoneyInterface {
    String toString();
    float getValue();
    float getCurrency();
}
----

Затем был создан абстрактный класс Money, имплементирующий интерфейс MoneyInteface и, содержащий абстрактный метод printInfo

.Код класса Money
[source,java]
----
public abstract class Money implements MoneyInterface {
    protected float value;
    protected float currency;
    protected String name;
    public Money(String name, float value, float currency) {
        this.value = value;
        this.currency = currency;
        this.name = name;
    }

    public static int compare(Money obj1, Money obj2) {
        return Float.compare(obj1.getCurrency()*obj1.getValue(),obj2.getCurrency()*obj2.getValue());
    }

    @Override
    public float getValue() {
        return value;
    }

    @Override
    public float getCurrency() {
        return currency;
    }

    @Override
    public String toString() {
        return "Parent "+name+": "+getValue();
    }
    public abstract void printInfo();
}
----

Для класса Money было создано два класса-потомка: Euro и Dollar

.Euro
[source,java]
----
package ru.rsatu.oop;

public class Euro extends Money{


    public Euro(float value) {
        super(Euro.class.getName(), value, 59.8f);
    }

    @Override
    public String toString() {
        return "Euro: "+getValue();
    }

    @Override
    public void printInfo() {
        System.out.println(this+ " currency: "+getCurrency());
    }
}
----

.Dollar
[source,java]
----
package ru.rsatu.oop;

public class Dollar extends Money{
    public Dollar(float value) {
        super("Dollar", value, 60.32f);
    }

    @Override
    public void printInfo() {
        System.out.println("DollarInfo: "+this+ "currency "+getCurrency());
    }
}
----

В исполняемый класс Main был добавлен и запущен пример использования.

.Пример в классе Main
[source,java]
----
Money m1 = new Euro(100);
Money m2 = new Dollar(100);
m1.printInfo();
m2.printInfo();
System.out.println(m2+" is bigger "+m1+": "+Money.compare(m1,m2));
----

.Результат работы скомпилированного файла
----
Euro: 100.0 currency: 59.8
DollarInfo: Parent Dollar: 100.0currency 60.32
Euro: 100.0 is bigger Parent Dollar: 100.0: -1
----

=== 3.2 Задание 2

Для выполнени задания 2, был создан создан класс Dump

.Класс Dump
[source,java]
----
public class Dump {
    public static void dumpEverything(String className) {
        try {
            Class<?> c = Class.forName(className);
            System.out.println("----------------------------"+className+"----------------------------");
            Method[] m = c.getMethods();
            System.out.println("----------------------------Methods----------------------------");
            for (Method method : m)
                System.out.println(method.toString());
            Field[] f = c.getDeclaredFields();
            System.out.println("----------------------------Fields----------------------------");
            for (Field field : f)
                System.out.println(field.toString());

        }
        catch (Throwable e) {
            System.err.println(e);
        }
    }

    public static Method getSomeMethod(Class<?> cls, String methodName, Class... parameterTypes) {
        try {
            return cls.getMethod(methodName, parameterTypes);
        } catch (SecurityException | NoSuchMethodException e) {
            return null;
        }
    }

    public static void printAllParents(Class<?> cls) {
        System.out.println("PrintAllParents:");
        while (cls != null) {
            System.out.println(cls.getName());
            cls = cls.getSuperclass();
        }
    }
}
----

Метод `dumpEverything` выводит на экран список всех методов и полей класса указанным названием

Для демонстрации его работы в класс `Main` был добавлен следующий код

.Пример в классе Main
[source, java]
----
Dump.dumpEverything(m1.getClass().getName());
Dump.dumpEverything(m1.getClass().getSuperclass().getName());
----

.Результат работы примера
[source, java]
----
----------------------------ru.rsatu.oop.Euro----------------------------
----------------------------Methods----------------------------
public java.lang.String ru.rsatu.oop.Euro.toString()
public void ru.rsatu.oop.Euro.printInfo()
public float ru.rsatu.oop.Money.getValue()
public static int ru.rsatu.oop.Money.compare(ru.rsatu.oop.Money,ru.rsatu.oop.Money)
public float ru.rsatu.oop.Money.getCurrency()
public final native void java.lang.Object.wait(long) throws java.lang.InterruptedException
public final void java.lang.Object.wait(long,int) throws java.lang.InterruptedException
public final void java.lang.Object.wait() throws java.lang.InterruptedException
public boolean java.lang.Object.equals(java.lang.Object)
public native int java.lang.Object.hashCode()
public final native java.lang.Class java.lang.Object.getClass()
public final native void java.lang.Object.notify()
public final native void java.lang.Object.notifyAll()
----------------------------Fields----------------------------
----------------------------ru.rsatu.oop.Money----------------------------
----------------------------Methods----------------------------
public java.lang.String ru.rsatu.oop.Money.toString()
public float ru.rsatu.oop.Money.getValue()
public static int ru.rsatu.oop.Money.compare(ru.rsatu.oop.Money,ru.rsatu.oop.Money)
public float ru.rsatu.oop.Money.getCurrency()
public abstract void ru.rsatu.oop.Money.printInfo()
public final native void java.lang.Object.wait(long) throws java.lang.InterruptedException
public final void java.lang.Object.wait(long,int) throws java.lang.InterruptedException
public final void java.lang.Object.wait() throws java.lang.InterruptedException
public boolean java.lang.Object.equals(java.lang.Object)
public native int java.lang.Object.hashCode()
public final native java.lang.Class java.lang.Object.getClass()
public final native void java.lang.Object.notify()
public final native void java.lang.Object.notifyAll()
----------------------------Fields----------------------------
protected float ru.rsatu.oop.Money.value
protected float ru.rsatu.oop.Money.currency
protected java.lang.String ru.rsatu.oop.Money.name
----

Метод `getSomeMethod` позволяет получить метод класса по указанному имени

Для демонстрации его работы в класс `Main` был добавлен следующий код

.Пример в классе Main
[source,java]
----
Method meth = Dump.getSomeMethod(m1.getClass(), "getValue");
try {
    System.out.println("\n\nReflection call getValue: " + meth.invoke(m1));
} catch (InvocationTargetException | IllegalAccessException e) {
    e.printStackTrace();
}

meth = Dump.getSomeMethod(Money.class, "compare", Money.class, Money.class);
try {
    System.out.println("Reflection static call compare: " + meth.invoke(null,m2,m1)+'\n');
} catch (InvocationTargetException | IllegalAccessException e) {
    e.printStackTrace();
}
----

.Результат выполнения примера
[source]
----


Reflection call getValue: 100.0
Reflection static call compare: 1

----

Метод `printAllParents` выводит всех предков указанного класса

Для демонстрации его работы в класс `Main` был добавлен следующий код

.Пример в классе Main
[source,java]
----
Dump.printAllParents(m1.getClass());
Dump.printAllParents(m2.getClass());
----

.Результат выполнения примера
[source]
----
PrintAllParents:
ru.rsatu.oop.Euro
ru.rsatu.oop.Money
java.lang.Object
PrintAllParents:
ru.rsatu.oop.Dollar
ru.rsatu.oop.Money
java.lang.Object
----

=== 3.3 Задание 3

...

== 4. Результаты выполнения

В результате выполнения первого задания был получен класс HelloWorld.
При запуске выводится строка:

image::images/1.png[]

В результате выполнения второго задания были получены классы main и HelloWorld.
При запуске main выводятся строки:

image::images/2.png[]

В результате выполнения третьего задания был получен jar-файл main.jar.
При запуске jar-файла выводятся строки:

image::images/3.png[]

== 5. Вывод

В результате выполнения лабораторной работы получены навыки по компиляции классов,
запуску проектов, созданию jar-файлов с помощью командной строки.